<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ–‡ç« é–±è®€</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css/github-markdown.min.css">
  <link rel="stylesheet" href="/css/templates.css">
</head>
<body>
  <button id="darkToggle">ğŸŒ™ å¤œé–“æ¨¡å¼</button>
  <div class="container">
    <!-- å·¦å´ç›®éŒ„ -->
    <nav id="toc-container">
      
      <button id="index">å›é¦–é </button>
      <h2>ç›®éŒ„</h2>
      <div id="toc"></div>
      
    </nav>

    <!-- å³å´æ–‡ç« å…§å®¹ -->
    <article id="content" class="markdown-body">
      è¼‰å…¥ä¸­...
    </article>

    <!-- å³å´æ–‡ç« å…§å®¹ 
    <nav id="toc-container">
      <h2>ç›®éŒ„</h2>
      <div id="toc"></div>
    </nav>
    -->
  </div>

  <button id="backToTop" title="å›åˆ°é ‚éƒ¨">â¬† Top</button>

  <!-- marked.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    async function loadMarkdown() {
      const params = new URLSearchParams(window.location.search);
      const file = params.get('file');
      if (!file) return;
    
      try {
        const res = await fetch("../" + file);
        if (!res.ok) throw new Error("HTTP " + res.status);
        const md = await res.text();
    
        // Markdown -> HTML
        document.getElementById("content").innerHTML = marked.parse(md);
    
        // ç”Ÿæˆ TOCï¼ˆåªæŠ“ h1 å’Œ h2ï¼‰
        const tocContainer = document.getElementById("toc");
        const headers = document.querySelectorAll("#content h1, #content h2, #content h3");
        let tocHtml = "<ul>";
    
        headers.forEach(h => {
          const id = h.textContent.replace(/\s+/g, "-");
          h.id = id;
    
          if (h.tagName === "H2") {
            tocHtml += `<li style="margin-left:15px">- <a href="#${id}">${h.textContent}</a></li>`;
          } else if (h.tagName === "H3") {
            tocHtml += `<li style="margin-left:30px">-- <a href="#${id}">${h.textContent}</a></li>`;
          } else { // h1
            tocHtml += `<li>â€¢ <a href="#${id}">${h.textContent}</a></li>`;
          }
        });
        tocHtml += "</ul>";
        tocContainer.innerHTML = tocHtml;
        mermaid.init(undefined, document.querySelectorAll(".mermaid"));
      } catch (err) {
        document.getElementById("content").innerHTML = "âš ï¸ ç„¡æ³•è¼‰å…¥æ–‡ç« ï¼š" + err.message;
      }
    }
    loadMarkdown();
</script>

<script src="/scripts/utils_templates/DarkMode.js"></script>
<script src="/scripts/utils_templates/BackSomewhere.js"></script>
<script type="module">
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ startOnLoad: true });
</script>

</body>
</html>
